---
title: "AnswerKey: Dakar Rally"
format: 
  html:
    embed-resources: true
---

In January of 2024, Saudi Arabia hosted the Dakar Rally, an epic off-road endurance event spanning thousands of kilometers across the rugged terrain. With 
drivers navigating deserts, mountains, and dunes, this race poses formidable challenges for all sorts of vehicles, such as bikes, cars, and trucks. Our 
focus will be on exploring the bikers ranking based off the racers time statistics and driver information.

```{r, message=FALSE, warning=FALSE}
library(tidyverse)
riders <- read_csv(here::here("Dakar Rally/data/dakarRally_bikes_data.csv"))
```

# 1.	

**Given the data, create a summary output that has the mean time as penalty times for each stage (make sure to incorporate minutes and seconds).**

## a. 

**Create Summary output**

```{r}
riders %>%
  group_by(Stage) %>%
  summarise(`num of riders` = n(),
            mean_hour_time = mean((Hours) + Minutes/60 + Seconds/3600), 
            mean_hour_penalty = mean((Penalty_Hours) + (Penalty_Minutes/60) + (Penalty_Seconds/3600))) %>%
  arrange(mean_hour_time, mean_hour_penalty)
```

## b.

**What stage in the race on average takes the riders the longest to complete?**

*The fifth stage of the race, 5-6, is the longest stage on average with 11ish hours*


## c.
**At what stage did the rider's seem to gain the most penalties on average?**

*The seventh stage of the race has the highest amount of penalties penalties on average with 6.9 hours*


## d. 

**Determine how many riders started the event versus ended it. How many rider's dropped out or were disqualified?**

*At the beginning the race there were 142 riders, however, in the end only 103 riders remained, meaning 39 riders were disqualified or dropped out.*




# 2.

**Now for some model building....**

## a.

**Fit a linear model that predicts a riders ranking based off their time (including penalties)**

```{r}
mod <- lm(Rank ~ (Hours) + (Minutes) + (Seconds) + (Penalty_Hours) + (Penalty_Minutes) + (Penalty_Seconds), data = riders)
```

## b.

**Test the significance of $\hat{\beta_{Minutes}}$**

*Hypothesis:*

*$H_O: \beta = 0$ *

*$H_A: \beta \not= 0$*

  Useful info:
    *$\hat{B}_{Minutes} = -0.08820$*
    *$B_i = 0$*
    *$\widehat{SE}_\hat{B}_{Minutes}$ = 0.04877*
    
  Test stat:
  
```{r}
n = 1584
(df = n-2)
(t = -0.08820/0.04877)
```

*Now using information above I can plug it into a t-test in statkey to obtain p-value.*

  *p = 2(0.035), and times two since we are looking at both tails*
    
  *p = 0.07 > 0.05, considered not very significant therefor the evidence is not strong enough.*
  
  *There is not enough evidence to reject the  $H_O$. (t = -1.808489, df = 1582, p = 0.07)*


## c.

**Now, looking $\hat{\beta_{Hours}}$, conduct a 95% confidence interval.**

```{r}
B_i = -0.16597
SEb = 0.03676
t1 = 1.962

(neg = B_i - (t1 * SEb))
(pos = B_i + (t1 * SEb))

c(neg, pos)
```

 *On average, with 95% confidence, the slope of the data cases will be between -0.238 and -0.094*



# 3.

**Based on the summary output, which stage(s) in the race are the most significant towards overall ranking and why?**

*Based on the answers to questions above one can conclude that the stages five through nine hold a lot of significance for ther esults of the race. Especially, with the fifth stage where on average it took riders about 11ish hours to complete, then looking at the penalties, majority recieved during the seventh and eighth stages. Overall, the fifth stage seems like it could be the most important as if the rider is able to achieve a time below average it would rank/place them in a very good position come the end of the race.*











  
