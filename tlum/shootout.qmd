---
title: "Shootout"
format: html
editor: visual
---

```{r}
library(dplyr)
library(tidyr)
library(readr)
library(rvest)
library(ggplot2)
```

```{r}
shootout <- read.csv("~/stat_289/stat_289_score/tlum/shootout.csv")
```

```{r}
shootout %>%
  summarise(mean(home_win))
```

```{r}
shootout %>% 
  group_by(Home) %>%
  summarise(mean(home_win))
```

```{r}
shootout %>%
  group_by(Visitor) %>%
  summarise(mean(home_win))
# visitor loss
```

`{r}m shootout <- shootout %>%   mutate(ANA = if_else(visitor == "Anaheim Ducks" | home == "Anaheim Ducks", 1, 0),          ARI = if_else(visitor == "Arizona Coyotes" | home == "Arizona Coyotes", 1, 0),          BOS = if_else(visitor == "Boston Bruins" | home == "Boston Bruins", 1, 0),          BUF = if_else(visitor == "Buffalo Sabres" | home == "Buffalo Sabres", 1, 0),          CGY = if_else(visitor == "Calgary Flames" | home == "Calgary Flames", 1, 0),          CAR = if_else(visitor == "Carolina Hurricanes" | home == "Carolina Hurricanes", 1, 0),          CHI = if_else(visitor == "Chicago Blackhawks" | home == "Chicago Blackhawks", 1, 0),          COL = if_else(visitor == "Colorado Avalanche" | home == "Colorado Avalanche", 1, 0),          CBJ = if_else(visitor == "Columbus Blue Jackets" | home == "Columbus Blue Jackets", 1, 0),          DAL = if_else(visitor == "Dallas Stars" | home == "Dallas Stars", 1, 0),          DET = if_else(visitor == "Detroit Red Wings" | home == "Detroit Red Wings", 1, 0),          EDM = if_else(visitor == "Edmonton Oilers" | home == "Edmonton Oilers", 1, 0),          FLA = if_else(visitor == "Florida Panthers" | home == "Florida Panthers", 1, 0),          LAK = if_else(visitor == "Los Angeles Kings" | home == "Los Angeles Kings", 1, 0),          MIN = if_else(visitor == "Minnesota Wild" | home == "Minnesota Wild", 1, 0),          MTL = if_else(visitor == "Montreal Canadiens" | home == "Montreal Canadiens", 1, 0),          NSH = if_else(visitor == "Nashville Predators" | home == "Nashville Predators", 1, 0),          NJD = if_else(visitor == "New Jersey Devils" | home == "New Jersey Devils", 1, 0),          NYI = if_else(visitor == "New York Islanders" | home == "New York Islanders", 1, 0),          NYR = if_else(visitor == "New York Rangers" | home == "New York Rangers", 1, 0),          OTT = if_else(visitor == "Ottawa Senators" | home == "Ottaw Senators", 1, 0),          PHI = if_else(visitor == "Philadelphia Flyers" | home == "Philadelphia Flyers", 1, 0),          PIT = if_else(visitor == "Pittsburgh Penguins" | home == "Pittsburgh Penguins", 1, 0),          SJ = if_else(visitor == "San Jose Sharks" | home == "San Jose Sharks", 1, 0),          SEA = if_else(visitor == "Seattle Kraken" | home == "Seattle Kraken", 1, 0),          STL = if_else(visitor == "St. Louis Blues" | home == "St. Louis Blues", 1, 0),          TBL = if_else(visitor == "Tampa Bay Lightning" | home == "Tampa Bay Lightning", 1, 0),          TOR = if_else(visitor == "Toronto Maple Leafs" | home == "Toronto Maple Leafs", 1, 0),          VAN = if_else(visitor == "Vancouver Canucks" | home == "Vancouver Canucks", 1, 0),          VGK = if_else(visitor == "Vegas Golden Knights" | home == "Vegas Giolden Knights", 1, 0),          WSH = if_else(visitor == "Washington Capitals" | home == "Washington Capitals", 1, 0),          WPG = if_else(visitor == "Winnipeg Jets" | home == "Winnipeg Jets", 1, 0))`

`{r}m tally <- c(6,7,7,6,7,7,4,9,2,7,7,4,3,9,13,7,8,6,6,7,1,3,2,7,4,6,5,3,8,6,6,2)`

`{r} team <- c("ANA", "ARI", "BOS", "BUF", "CGY", "CAR", "CHI", "COL", "CBJ", "DAL", "DET", "EDM","FLA", "LAK", "MIN", "MTL", "NSH", "NJD", "NYI", "NYR", "OTT", "PHI", "PIT", "SJ", "SEA", "STL", "TBL", "TOR", "VAN", "VGK", "WSH", "WPG")`
```{r}
team <- c("ANA", "ARI", "BOS", "BUF", "CGY", "CAR", "CHI", "COL", "CBJ", "DAL", "DET", "EDM","FLA", "LAK", "MIN", "MTL", "NSH", "NJD", "NYI", "NYR", "OTT", "PHI", "PIT", "SJ", "SEA", "STL", "TBL", "TOR", "VAN", "VGK", "WSH", "WPG")
```


`{r}m count <- bind_cols(team, tally)`

`{r}m count <- count %>%   rename(team = "...1", count = "...2") %>%   mutate(percent = count / 82)`

```{r}
count %>% ggplot() +
  geom_point(aes(x = team, y = count, color = team))
```

```{r}
shootout %>%
  summarise(sum(home_win))
```

```{r}
prop.test(40, 95, p = 0.5)
```

```{r}
shootout_2122 <- read_delim("~/OneDrive - St. Lawrence University/2021_2022.csv", delim = ",")
```

```{r}m
shootout_2122 <- shootout_2122 %>%
  filter(extra_time == "SO") %>%
  mutate(ANA = if_else(visitor == "Anaheim Ducks" | home == "Anaheim Ducks", 1, 0),          ARI = if_else(visitor == "Arizona Coyotes" | home == "Arizona Coyotes", 1, 0),          BOS = if_else(visitor == "Boston Bruins" | home == "Boston Bruins", 1, 0),          BUF = if_else(visitor == "Buffalo Sabres" | home == "Buffalo Sabres", 1, 0),          CGY = if_else(visitor == "Calgary Flames" | home == "Calgary Flames", 1, 0),          CAR = if_else(visitor == "Carolina Hurricanes" | home == "Carolina Hurricanes", 1, 0),          CHI = if_else(visitor == "Chicago Blackhawks" | home == "Chicago Blackhawks", 1, 0),          COL = if_else(visitor == "Colorado Avalanche" | home == "Colorado Avalanche", 1, 0),          CBJ = if_else(visitor == "Columbus Blue Jackets" | home == "Columbus Blue Jackets", 1, 0),          DAL = if_else(visitor == "Dallas Stars" | home == "Dallas Stars", 1, 0),          DET = if_else(visitor == "Detroit Red Wings" | home == "Detroit Red Wings", 1, 0),          EDM = if_else(visitor == "Edmonton Oilers" | home == "Edmonton Oilers", 1, 0),          FLA = if_else(visitor == "Florida Panthers" | home == "Florida Panthers", 1, 0),          LAK = if_else(visitor == "Los Angeles Kings" | home == "Los Angeles Kings", 1, 0),          MIN = if_else(visitor == "Minnesota Wild" | home == "Minnesota Wild", 1, 0),          MTL = if_else(visitor == "Montreal Canadiens" | home == "Montreal Canadiens", 1, 0),          NSH = if_else(visitor == "Nashville Predators" | home == "Nashville Predators", 1, 0),          NJD = if_else(visitor == "New Jersey Devils" | home == "New Jersey Devils", 1, 0),          NYI = if_else(visitor == "New York Islanders" | home == "New York Islanders", 1, 0),          NYR = if_else(visitor == "New York Rangers" | home == "New York Rangers", 1, 0),          OTT = if_else(visitor == "Ottawa Senators" | home == "Ottaw Senators", 1, 0),          PHI = if_else(visitor == "Philadelphia Flyers" | home == "Philadelphia Flyers", 1, 0),          PIT = if_else(visitor == "Pittsburgh Penguins" | home == "Pittsburgh Penguins", 1, 0),          SJ = if_else(visitor == "San Jose Sharks" | home == "San Jose Sharks", 1, 0),          SEA = if_else(visitor == "Seattle Kraken" | home == "Seattle Kraken", 1, 0),          STL = if_else(visitor == "St. Louis Blues" | home == "St. Louis Blues", 1, 0),          TBL = if_else(visitor == "Tampa Bay Lightning" | home == "Tampa Bay Lightning", 1, 0),          TOR = if_else(visitor == "Toronto Maple Leafs" | home == "Toronto Maple Leafs", 1, 0),          VAN = if_else(visitor == "Vancouver Canucks" | home == "Vancouver Canucks", 1, 0),          VGK = if_else(visitor == "Vegas Golden Knights" | home == "Vegas Giolden Knights", 1, 0),          WSH = if_else(visitor == "Washington Capitals" | home == "Washington Capitals", 1, 0),          WPG = if_else(visitor == "Winnipeg Jets" | home == "Winnipeg Jets", 1, 0)) %>%
  select(-c(7))
  
```

```{r}
tally <- c(6,7,7,6,7,7,4,9,2,7,7,4,3,9,13,7,8,6,6,7,1,3,2,7,4,6,5,3,8,6,6,2)
tally2 <- shootout_2122 %>%
  select(c(7:38)) %>%
  colSums()
```

```{r}
count_2223 <- bind_cols(team, tally) %>%
  rename(team = "...1",
         count = "...2")
count_2122 <- bind_cols(team, tally2) %>%
  rename(team = "...1",
         count = "...2")
```

```{r}
count_2223 <- count_2223 %>%
  mutate(so_pct = count / 82)
count_2122 <- count_2122 %>%
  mutate(so_pct = count / 82)
```

```{r}
write_csv(count_2223, "~/stat_289/stat_289_score/tlum/count_2223.csv")
```

```{r}
write_csv(count_2122, "~/stat_289/stat_289_score/tlum/count_2122.csv")
```


```{r}
summary(glm(home_win~attendance, data = shootout))
```
```{r}
plot(home_win~h_goals, data = shootout)
```
```{r}
shootout_2122 <- shootout_2122 %>%
  mutate(home_win = if_else(h_goals > v_goals, TRUE, FALSE)) %>%
  relocate(home_win, .after = attendance)
```

```{r}
write_csv(shootout_2122, "~/stat_289/stat_289_score/tlum/shootout_2122.csv")
```


```{r}
write_csv(shootout_2223, "~/stat_289/stat_289_score/tlum/shootout_2223.csv")
```


if home team wins more 
```{r}
```

```{r}
table(shootout_2223$home_win)
```


```{r}
prop.test(40, 95 , p = 0.5 )
```


