---
title: "Cleaning, Merging, and Analyzing Football Data Key"
author: "Brendan Karadenes"
format: html
---

# Introduction

College football has the most widely followed recruiting cycle of any college sport. The top high school players are often being looked at years before they graduate. One of the top recruited positions are wide receivers. Wide receivers are responsible for catching passes from the quarterback and running down the field to gain the most yards as possible. They are an integral part of the offense. 

We will be investigating recruiting data from 2013 to 2019 for high school wide receivers. We are interested in cleaning the data and analyzing the impact some of them had in the NFL in 2023.

# Data Description
Tm - NFL team the player played for in 2023
Ranking - Recruiting ranking of the player coming out of high school. The lower rankings mean that a player is a top prospect (i.e. a player ranked 1 would be the top prospect in their class)
Year - Year that recruit graduated high school
Yds - Number of receiving yards player had in 2023

# Exercises

To begin, load in the necessary packages and the **college_FB.csv** file. The data contains recruiting information for Division 1 college football recruits and statistics for those who played in the NFL in 2023.

```{r message=FALSE, warning=FALSE}
library(tidyverse)
library(here)
football <- read.csv(here("football.csv"))
```

1. Create two sets of data, one containing players that competed in the NFL in 2023 and another that contains players who didn't compete in the NFL in 2023.  

```{r}
# data set with the NFL players
nfl_2023 <- football %>%
  filter(!is.na(Tm))
```

```{r}
# data set without the NFL players
non_nfl2023 <- football %>%
  filter(is.na(Tm))
```

2. Notice that the data set that contains players that competed in the NFL in 2023 has players not in the recruiting class from 2013 to 2019. Filter out those players using the `Ranking` and `Tm` variable.

```{r}
nfl_recruits_2023 <- football %>%
  filter(!is.na(Tm),
         !is.na(Ranking))
```

3. How many wide receivers in 2023 were ranked in the top 100 in their high school recruiting class? What are some possible reasons why lower ranked players were playing in 2023 over higher ranked players?

```{r}
nfl_2023 %>%
  filter(Ranking < 100) %>%
  summarise(n())
```

In the 2023 NFL there were 20 wide receivers who were a part of the top 100 in their high school recruiting class. Some possibilities that explain why lower ranked players were playing over higher ranked players include injury and larger improvements in college.

4. Let's practice splitting and joining tables using dplyr. Make three different new data frames: one being from recruiting years 2013-14, another from 2015-16, and the last from 2017-19.

```{r}
nfl_13_14 <- nfl_recruits_2023 %>%
  filter(Year >= 2013 & Year <= 2014)
```

```{r}
nfl_15_16 <- nfl_recruits_2023 %>%
  filter(Year >= 2015 & Year <= 2016)
```

```{r}
nfl_17_19 <- nfl_recruits_2023 %>%
  filter(Year >= 2017 & Year <= 2019)
```

5. Find the mean number of receiving yards for 2023 in each recruiting year group. Which group had the lowest and which had the highest?

```{r}
nfl_13_14 %>%
  summarise(mean(Yds))
nfl_15_16 %>%
  summarise(mean(Yds))
nfl_17_19 %>%
  summarise(mean(Yds))
```

The recruits from 2017-2019 had the highest mean number of receiving yards in the NFL in 2023, while recruits from 2015-2016 had the lowest mean number of receiving yards.

6. Find the mean rankings for each group of years. Do the lowest ranking years have the highest mean receiving yards? Explain.

```{r}
nfl_13_14 %>%
  summarise(mean(Ranking))
nfl_15_16 %>%
  summarise(mean(Ranking))
nfl_17_19 %>%
  summarise(mean(Ranking))
```

No, the group with the lowest mean ranking (2015-16) actually had the fewest number of mean yards. Years 2017-2019 had the second lowest mean ranking and the most number of mean receiving yards and years 2013-2014 had by far the highest mean ranking and the second highest number of receiving yards.

7. Use `bind_rows()` to merge the three data frames for the 3 different groups of years back together so they are all in one data set again.

```{r}
nfl_13_16<- bind_rows(nfl_13_14, nfl_15_16)
nfl_full <- bind_rows(nfl_13_16, nfl_17_19)
```

8. Make a simple scatterplot of recruiting ranking vs. receiving yards in the NFL. What is the general trend?

```{r}
ggplot(data = nfl_full,mapping = aes(x = Ranking, y = Yds)) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(title = "Trend of Ranking vs. Receiving Yards") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))
```

The general trend is that as player's rank number increases their receiving yards in the NFL decreases.
